---
hide_table_of_contents: true
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import useBaseUrl from '@docusaurus/useBaseUrl';

# ğŸ¼ Pandas et ğŸ¤– Scikit-learn

# ğŸ—ï¸ en construction ğŸ—

<Tabs queryString="onglet">

    <TabItem value="data" label="Analyse de donnÃ©es" default>

        :::tip ğŸ’¡ Introduction Ã  l'analyse de donnÃ©es

        ğŸ“Š Pour votre **TP2**, vous allez devoir manipuler des **donnÃ©es rÃ©elles** :

        - ğŸ“¥ Charger des ensembles de donnÃ©es Ã  partir de fichiers **CSV**.
        - ğŸ§¹ **Nettoyer et prÃ©traiter** les donnÃ©es pour les rendre exploitables.
        - ğŸ” **Analyser** les donnÃ©es pour en extraire des informations pertinentes.
        - ğŸ“ˆ **Visualiser** les donnÃ©es Ã  l'aide de graphiques.
        - ğŸ¤– Utiliser des techniques dâ€™**apprentissage automatique** pour construire des modÃ¨les prÃ©dictifs.

        ğŸ§  Cela nÃ©cessite une bonne comprÃ©hension des **concepts** et des **outils dâ€™analyse de donnÃ©es**.

        ---

        ğŸ”¬ Lâ€™**analyse de donnÃ©es** est un processus essentiel qui consiste Ã  examiner, nettoyer, transformer et modÃ©liser des donnÃ©es dans le but de **dÃ©couvrir des informations utiles**, **informer des conclusions** et **soutenir la prise de dÃ©cision**.

        ---

        ğŸ§° **BibliothÃ¨ques Python couramment utilisÃ©es** pour lâ€™analyse de donnÃ©es :

        - ğŸ¼ **Pandas** : pour la **manipulation et lâ€™analyse** de donnÃ©es, offrant des structures de type *DataFrame*.
        - ğŸ”¢ **NumPy** : pour le **calcul scientifique** et les opÃ©rations sur des tableaux multidimensionnels.
        - ğŸ¤– **Scikit-learn** : pour lâ€™**apprentissage automatique** et la modÃ©lisation prÃ©dictive.
        - ğŸ§  **Keras** et **TensorFlow** : pour le dÃ©veloppement de modÃ¨les dâ€™**apprentissage profond** (*deep learning*).
        - ğŸ¨ **Matplotlib** et **Seaborn** : pour la **visualisation** de donnÃ©es.
        - â€¦ et bien dâ€™autres selon les besoins !

        ---

        ğŸ§© Vous connaissez dÃ©jÃ  :
        - ğŸ¨ **Matplotlib** pour la **visualisation**
        - ğŸ”¢ **NumPy** pour les **calculs numÃ©riques**

        ğŸ“… Cette semaine, nous allons apprendre Ã  utiliser deux nouvelles bibliothÃ¨ques essentielles pour votre TP2 :
        ğŸ¼ **Pandas** et ğŸ¤– **Scikit-learn**.<br />
        ğŸ‘‰ La semaine prochaine, nous aborderons les concepts dâ€™**intelligence artificielle** et dâ€™**apprentissage profond** (*deep learning*).

        :::

    </TabItem>

    <TabItem value="pandas" label="ğŸ¼ Pandas">

        :::info Introduction Ã  ğŸ¼ Pandas

        Pandas est une bibliothÃ¨que Python essentielle pour la manipulation et l'analyse de donnÃ©es. Elle offre des structures de donnÃ©es flexibles et performantes, telles que les *DataFrames*, qui facilitent le traitement des donnÃ©es tabulaires.

        :::

        ---

        :::info Le DataFrame

        Le **DataFrame** est la structure de donnÃ©es principale de Pandas. Il s'agit d'une table bidimensionnelle, similaire Ã  une feuille de calcul Excel, oÃ¹ les donnÃ©es sont organisÃ©es en lignes et en colonnes. Chaque colonne peut contenir des types de donnÃ©es diffÃ©rents (nombres, chaÃ®nes de caractÃ¨res, dates, etc.).

        On peut crÃ©er un DataFrame Ã  partir de diverses sources de donnÃ©es, telles que des fichiers CSV, des bases de donnÃ©es SQL, ou mÃªme des dictionnaires Python.

        :::

        ---

        :::info CrÃ©ation d'un DataFrame Ã  partir d'un dictionnaire
        ```python
        import pandas as pd

        # CrÃ©ation d'un DataFrame Ã  partir d'un dictionnaire
        data = {'Nom': ['Alice', 'Bob', 'Charlie'],
                'Ã‚ge': [25, 30, 35],
                'Ville': ['Paris', 'Lyon', 'Marseille']}
        df = pd.DataFrame(data)

        # Affichage du DataFrame
        print(df)
        ```
        Cela produira le DataFrame suivant :
        ```
               Nom  Ã‚ge      Ville
        0    Alice   25      Paris
        1      Bob   30       Lyon
        2  Charlie   35  Marseille
        ```
        - Les clÃ©s du dictionnaire deviennent les noms des colonnes, et chaque liste associÃ©e Ã  une clÃ© devient une colonne de donnÃ©es.
        - La premiÃ¨re colonne (0, 1, 2) est l'index par dÃ©faut des lignes.
        - La premiÃ¨re ligne reprÃ©sente les en-tÃªtes des colonnes.
        - Chaque ligne suivante reprÃ©sente un enregistrement (une personne dans cet exemple).

        :::

        ---

        :::info Lire un fichier CSV avec Pandas

        Le fichier <a href={useBaseUrl('/ressources/csv/tips_dataset.csv')} download="tips_dataset.csv">tips_dataset.csv</a> contient des donnÃ©es sur les pourboires donnÃ©s dans un restaurant, avec des colonnes telles que le montant total de la facture, le pourboire, le sexe du serveur, etc.

        ```csv
        total_bill,tip,sex,smoker,day,time,size
        16.99,1.01,Female,No,Sun,Dinner,2
        10.34,1.66,Male,No,Sun,Dinner,3
        21.01,3.5,Male,No,Sun,Dinner,3
        23.68,3.31,Male,No,Sun,Dinner,2
        ...
        ```
        Si vous le <a href={useBaseUrl('/ressources/csv/tips_dataset.csv')} download="tips_dataset.csv">tÃ©lÃ©chargez</a> et le placez dans votre projet Pycharm, vous pouvez le lire avec Pandas comme ceci :
        ```python
        import pandas as pd

        # Lire le fichier CSV dans un DataFrame
        df = pd.read_csv('tips_dataset.csv')

        # Afficher les premiÃ¨res lignes du DataFrame
        print(df.head())
        ```
        Cela produira un DataFrame qui ressemble Ã  ceci (seules les 5 premiÃ¨res lignes sont affichÃ©es) :
        ```
           total_bill   tip     sex smoker  day    time  size
        0       16.99  1.01  Female     No  Sun  Dinner     2
        1       10.34  1.66    Male     No  Sun  Dinner     3
        2       21.01  3.50    Male     No  Sun  Dinner     3
        3       23.68  3.31    Male     No  Sun  Dinner     2
        4       24.59  3.61  Female     No  Sun  Dinner     4
        ```

        :::

        ---

        :::info OpÃ©rations clÃ©s avec ğŸ¼ Pandas

        Une fois vos donnÃ©es chargÃ©es dans un DataFrame, vous pouvez effectuer une grande variÃ©tÃ© dâ€™opÃ©rations pour les explorer, les transformer et en extraire de lâ€™information utile.

        Voici quelques exemples pratiques avec le DataFrame `df` du fichier **tips_dataset.csv** :

        ---

        ### ğŸ‘€ Afficher et explorer les donnÃ©es

        ```python
        # Affiche les 5 premiÃ¨res lignes du DataFrame
        print(df.head())

        # Affiche les informations sur les colonnes et les types de donnÃ©es
        df.info()

        # Affiche des statistiques descriptives (moyenne, min, max, etc.)
        print(df.describe())
        ```
        Cette derniÃ¨re commande `df.describe()` permet dâ€™obtenir un rÃ©sumÃ© statistique rapide des colonnes numÃ©riques du DataFrame, incluant des mesures telles que la moyenne, lâ€™Ã©cart-type, les valeurs minimales et maximales, ainsi que les quartiles :
        ```
               heures_etude  heures_sommeil  niveau_stress       note
        count     15.000000       15.000000      15.000000  15.000000
        mean       4.733333        6.333333       5.733333  82.733333
        std        2.077659        1.554563       2.313521   6.076496
        min        1.500000        4.000000       2.000000  72.000000
        25%        3.250000        5.250000       4.000000  78.500000
        50%        5.000000        6.500000       6.000000  83.000000
        75%        6.250000        7.250000       7.500000  87.000000
        max        8.000000        9.000000       9.000000  92.000000
        ```

        ---

        ### ğŸ¯ SÃ©lectionner des colonnes et des lignes

        ```python
        # SÃ©lection d'une colonne
        df["note"]

        # SÃ©lection de plusieurs colonnes
        df[["etudiant", "note", "jour"]]

        # SÃ©lection d'une ligne par son index
        df.loc[3]    # quatriÃ¨me ligne (index = 3)
        ```

        ---

        ### ğŸ” Filtrer les donnÃ©es

        ```python
        # Ã‰tudiants ayant dormi moins de 6 heures
        df[df["heures_sommeil"] < 6]

        # Ã‰tudiants ayant obtenu une note supÃ©rieure Ã  85
        df[df["note"] > 85]

        # Ã‰tudiants stressÃ©s (niveau_stress >= 8)
        df[df["niveau_stress"] >= 8]
        ```

        ---

        ### ğŸ“ˆ Trier et ordonner les donnÃ©es

        ```python
        # Trier par note dÃ©croissante
        df.sort_values("note", ascending=False)

        # Trier par nombre dâ€™heures dâ€™Ã©tude, puis de sommeil
        df.sort_values(["heures_etude", "heures_sommeil"])
        ```

        ---

        ### ğŸ§® CrÃ©er de nouvelles colonnes

        ```python
        # Ajouter un ratio entre les heures d'Ã©tude et de sommeil
        df["ratio_etude_sommeil"] = df["heures_etude"] / df["heures_sommeil"]
        print(df.head())
        ```
        Cela ajoutera une nouvelle colonne `ratio_etude_sommeil` au DataFrame, calculÃ©e en divisant les heures d'Ã©tude par les heures de sommeil pour chaque Ã©tudiant :
        ```
              etudiant  heures_etude  heures_sommeil  niveau_stress  note      jour  ratio_etude_sommeil
        0       AmÃ©lie           4.0             7.5              5    82     Lundi             0.533333
        1        Mahdi           2.0             8.0              3    78     Lundi             0.250000
        2        Julie           6.5             5.0              8    90     Mardi             1.300000
        3          Sam           7.0             4.5              9    88     Mardi             1.555556
        4       Ã‰lodie           3.0             6.5              4    76  Mercredi             0.461538
        ```

        ---

        ### ğŸ§  Statistiques et agrÃ©gations

        ```python
        # Moyenne gÃ©nÃ©rale des notes
        df["note"].mean()

        # Moyenne des heures d'Ã©tude par jour
        df.groupby("jour")["heures_etude"].mean()

        # Moyenne des notes selon le niveau de stress
        df.groupby("niveau_stress")["note"].mean()
        ```

        ---

        ### ğŸ§¹ Nettoyage de donnÃ©es

        ```python
        # VÃ©rifier la prÃ©sence de valeurs manquantes
        df.isna().sum()

        # Remplacer les valeurs manquantes par la moyenne de la colonne
        df["heures_sommeil"].fillna(df["heures_sommeil"].mean(), inplace=True)

        # Supprimer les lignes incomplÃ¨tes
        df.dropna(inplace=True)
        ```

        ---

        ### ğŸ“Š Visualisation rapide (avec Matplotlib intÃ©grÃ©)

        ```python
        import matplotlib.pyplot as plt

        # Diagramme de dispersion : sommeil vs note
        df.plot.scatter(x="heures_sommeil", y="note", title="Relation entre sommeil et note")
        plt.show()

        # Moyenne des notes par jour (diagramme en barres)
        df.groupby("jour")["note"].mean().plot(kind="bar", title="Moyenne des notes par jour")
        plt.show()
        ```

        ---

        ğŸ’¡ **En rÃ©sumÃ© :**
        - `df.head()` âœ aperÃ§u rapide
        - `df[...]` âœ sÃ©lection ou filtrage
        - `df.sort_values()` âœ tri
        - `df.groupby()` âœ regroupement et statistiques
        - `df.plot()` âœ visualisation rapide

        Pandas vous permet de passer **dâ€™un simple fichier CSV Ã  une analyse complÃ¨te** en quelques lignes seulement. ğŸ¯

        :::

    </TabItem>

    <TabItem value="learn" label="ğŸ¤– Scikit-learn">

        :::info Introduction Ã  ğŸ¤– Scikit-learn

        Scikit-learn est une bibliothÃ¨que Python puissante pour l'apprentissage automatique. Elle fournit des outils simples et efficaces pour la modÃ©lisation prÃ©dictive, y compris des algorithmes de classification, de rÃ©gression et de clustering.

        ### Concepts clÃ©s de Scikit-learn
        - **ModÃ¨les** : Scikit-learn propose une large gamme d'algorithmes d'apprentissage automatique, tels que les forÃªts alÃ©atoires, les machines Ã  vecteurs de support (SVM) et les rÃ©seaux de neurones.
        - **PrÃ©traitement des donnÃ©es** : La bibliothÃ¨que offre des outils pour normaliser, standardiser et encoder les donnÃ©es avant de les utiliser dans des modÃ¨les.
        - **Ã‰valuation des modÃ¨les** : Scikit-learn fournit des mÃ©triques pour Ã©valuer la performance des modÃ¨les, telles que la prÃ©cision, le rappel et la courbe ROC (non, non, pas *Rest of Canada* mais plutÃ´t *Receiver Operating Characteristic* ğŸ¤ª).
        - **Pipeline** : Permet de chaÃ®ner plusieurs Ã©tapes de traitement et de modÃ©lisation en un seul objet.

        ---

        ### Exemple d'utilisation de Scikit-learn pour visualiser une rÃ©gression linÃ©aire
        ```python
        import numpy as np
        import matplotlib.pyplot as plt
        from sklearn.linear_model import LinearRegression

        # GÃ©nÃ©rer des donnÃ©es synthÃ©tiques
        np.random.seed(0)
        X = 2 * np.random.rand(100, 1)
        y = 4 + 3 * X + np.random.randn(100, 1)

        # CrÃ©er et entraÃ®ner le modÃ¨le de rÃ©gression linÃ©aire
        model = LinearRegression()
        model.fit(X, y)
        # PrÃ©dire les valeurs
        X_new = np.array([[0], [2]])
        y_predict = model.predict(X_new)

        # Visualiser les rÃ©sultats
        plt.scatter(X, y, color='blue', label='DonnÃ©es rÃ©elles')
        plt.plot(X_new, y_predict, color='red', linewidth=2, label='RÃ©gression linÃ©aire')
        plt.xlabel('X')
        plt.ylabel('y')
        plt.title('RÃ©gression LinÃ©aire avec Scikit-learn')
        plt.legend()
        plt.show()
        ```



        :::


        :::info ğŸš— DÃ©monstration : Consommation dâ€™essence et caractÃ©ristiques des voitures

Dans ce mini-exemple, on utilise le jeu de donnÃ©es classique **Auto MPG** (Miles per Gallon) pour explorer la relation entre la **consommation dâ€™essence** (`mpg`) et des variables comme le **poids** (`weight`) ou le **nombre de cylindres** (`cylinders`).

---

### ğŸ§° Chargement du jeu de donnÃ©es

Le dataset `mpg` est directement disponible dans la bibliothÃ¨que **Seaborn** :

```python
import seaborn as sns
import pandas as pd

# Chargement du jeu de donnÃ©es
df = sns.load_dataset("mpg")

# AperÃ§u
print(df.head())
print(df.info())
```

---

### ğŸ” Exploration rapide

```python
# Colonnes principales
print(df[["mpg", "cylinders", "weight", "horsepower", "acceleration"]].describe())

# Moyenne de la consommation par nombre de cylindres
print(df.groupby("cylinders")["mpg"].mean())

# Visualisation simple
import matplotlib.pyplot as plt
sns.scatterplot(x="weight", y="mpg", data=df)
plt.title("Relation entre le poids du vÃ©hicule et la consommation (mpg)")
plt.show()
```

ğŸ’¡ On observe une relation **inverse** : plus le vÃ©hicule est lourd, plus la consommation (en mpg) est faible.

---

### ğŸ§® RÃ©gression linÃ©aire simple (Scikit-learn)

Nous allons modÃ©liser cette relation avec `LinearRegression` â€” **sans train/test split**, juste pour visualiser la tendance.

```python
from sklearn.linear_model import LinearRegression
import numpy as np

# Suppression des valeurs manquantes
df = df.dropna(subset=["mpg", "weight"])

# PrÃ©paration des variables
X = df[["weight"]]    # variable explicative
y = df["mpg"]         # variable cible

# ModÃ¨le linÃ©aire
model = LinearRegression().fit(X, y)

print("Coefficient :", model.coef_[0])
print("Intercept :", model.intercept_)
print("Score RÂ² :", model.score(X, y))
```

---

### ğŸ“ˆ Visualisation de la rÃ©gression

```python
plt.scatter(X, y, label="DonnÃ©es rÃ©elles", alpha=0.6)
plt.plot(X, model.predict(X), color="red", label="RÃ©gression linÃ©aire")
plt.xlabel("Poids du vÃ©hicule")
plt.ylabel("Consommation (mpg)")
plt.title("RÃ©gression linÃ©aire : Poids vs Consommation")
plt.legend()
plt.show()
```

ğŸ’¬ On obtient une droite de tendance montrant que :
> ğŸ”» Plus le poids augmente, plus la consommation (mpg) diminue.

---

### âš™ï¸ RÃ©gression multiple (optionnel)

On peut facilement ajouter dâ€™autres variables (ex. nombre de cylindres, puissance) :

```python
df = df.dropna(subset=["mpg", "weight", "cylinders", "horsepower"])
X_multi = df[["weight", "cylinders", "horsepower"]]
y = df["mpg"]

model_multi = LinearRegression().fit(X_multi, y)
print("Coefficients :", model_multi.coef_)
print("Score RÂ² :", model_multi.score(X_multi, y))
```

ğŸ’¡ Cela montre comment Scikit-learn peut servir Ã  **analyser** et **visualiser** des tendances, mÃªme sans validation ni prÃ©diction.

---

### ğŸ§  Ã€ retenir

| Objectif | Outil |
|-----------|-------|
| Charger et explorer les donnÃ©es | ğŸ¼ Pandas + Seaborn |
| Visualiser les relations | ğŸ“Š Matplotlib / Seaborn |
| ModÃ©liser une tendance | ğŸ¤– Scikit-learn (LinearRegression) |
| Valider un modÃ¨le complet | (optionnel) train/test split |

> Scikit-learn nâ€™est pas rÃ©servÃ© au machine learning complexe :
> il peut aussi servir Ã  **confirmer visuellement une hypothÃ¨se statistique** simple. ğŸ¯

:::

    </TabItem>

    <TabItem value="pipeline" label="Pipeline">

    </TabItem>

    <TabItem value="exercices" label="Exercices">

        ## âœï¸ Exercices de comprÃ©hension

        :::info Exercice -

        :::

        ## ğŸ”¨ Exercices de crÃ©ation

        :::info Exercice -

        :::

        :::info Exercice -

        :::

        :::info Exercice -

        :::

        :::info Exercice -

        :::

    </TabItem>

</Tabs>


